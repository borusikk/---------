{% extends 'base.html' %}
{% block title %}üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞</h2>

    <!-- –¢–û–ü-10 –ö–∞—Ñ–µ–¥—Ä –∑–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–º -->
    <h3 class="mt-4">üè´ –¢–æ–ø-10 –∫–∞—Ñ–µ–¥—Ä –∑–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–º</h3>
    <canvas id="departmentsChart"></canvas>

    <!-- –¢–û–ü-5 –í–∏–∫–ª–∞–¥–∞—á—ñ–≤ -->
    <h3 class="mt-4">üèÜ –¢–æ–ø-5 –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤</h3>
    <canvas id="professorsChart"></canvas>

    <!-- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–≥—É–∫—ñ–≤ –ø–æ –∫–∞—Ñ–µ–¥—Ä–∞—Ö -->
    <h3 class="mt-4">üìå –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–≥—É–∫—ñ–≤ –ø–æ –∫–∞—Ñ–µ–¥—Ä–∞—Ö</h3>
    <canvas id="feedbacksChart"></canvas>
</div>

<!-- –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // –ì—Ä–∞—Ñ—ñ–∫ –∫–∞—Ñ–µ–¥—Ä
    var ctx1 = document.getElementById('departmentsChart').getContext('2d');
    var departmentsChart = new Chart(ctx1, {
        type: 'bar',
        data: {
            labels: [{% for d in departments %}"{{ d.name }}",{% endfor %}],
            datasets: [{
                label: '–°–µ—Ä–µ–¥–Ω—ñ–π —Ä–µ–π—Ç–∏–Ω–≥',
                data: [{% for d in departments %}{{ d.avg_rating|floatformat:1 }},{% endfor %}],
                backgroundColor: 'rgba(54, 162, 235, 0.7)'
            }]
        }
    });

    // –ì—Ä–∞—Ñ—ñ–∫ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤
    var ctx2 = document.getElementById('professorsChart').getContext('2d');
    var professorsChart = new Chart(ctx2, {
        type: 'bar',
        data: {
            labels: [{% for p in top_professors %}"{{ p.name }}",{% endfor %}],
            datasets: [{
                label: '–°–µ—Ä–µ–¥–Ω—ñ–π —Ä–µ–π—Ç–∏–Ω–≥',
                data: [{% for p in top_professors %}{{ p.avg_rating|floatformat:1 }},{% endfor %}],
                backgroundColor: 'rgba(255, 99, 132, 0.7)'
            }]
        }
    });

    // –ì—Ä–∞—Ñ—ñ–∫ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –≤—ñ–¥–≥—É–∫—ñ–≤
    var ctx3 = document.getElementById('feedbacksChart').getContext('2d');
    var feedbacksChart = new Chart(ctx3, {
        type: 'bar',
        data: {
            labels: [{% for d in department_feedbacks %}"{{ d.name }}",{% endfor %}],
            datasets: [{
                label: '–ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–≥—É–∫—ñ–≤',
                data: [{% for d in department_feedbacks %}{{ d.feedback_count }},{% endfor %}],
                backgroundColor: 'rgba(75, 192, 192, 0.7)'
            }]
        }
    });
</script>
{% endblock %}
